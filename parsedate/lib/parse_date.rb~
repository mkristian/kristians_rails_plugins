# Parsedate
module ParseDate
  
  # helper methods used by more than one controller
  def parsedate(ref, varname, default = nil)
    if ref.nil? or ref.size == 0
      nil
    end
    begin
      ref[varname] = Date.parse("#{ref[varname + '(1i)']}-#{ref[varname + '(2i)']}-#{ref[varname + '(3i)']}")
      ref.delete(varname + '(1i)')
      ref.delete(varname + '(2i)')
      ref.delete(varname + '(3i)')
      nil
    rescue ArgumentError => e
      ref[varname] = default.nil? ? Time.today : default
      "invalid #{varname}"
    end
  end

end
